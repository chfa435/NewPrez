@model IEnumerable<NewTiceAI.Models.ActionItem>
@inject IOrganizationService _OrgService

@{
    ViewData["Title"] = "Index";
    int orgId = User.Identity!.GetOrganizationId();
    Organization? TiceAI = await _OrgService.GetOrgInfoById(orgId);
    ActionItem? ActionItem = new();
}

<link rel="stylesheet" href="~/assets/vendor/libs/select2/select2.css" />
<link rel="stylesheet" href="~/assets/vendor/libs/form-validation/umd/styles/index.min.css" />



@if (TiceAI.Name == "Sittadel" || TiceAI.Name == "Stambrisk")
{
    <div class="row g-4 mb-4">
        <div class="col-sm-6 col-xl-3">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex align-items-start justify-content-between">
                        <div class="content-left">
                            <span>Session</span>
                            <div class="d-flex align-items-end mt-2">
                                <h4 class="mb-0 me-2">21,459</h4>
                                <small class="text-success mb-0">(+29%)</small>
                            </div>
                            <small>Total Users</small>
                        </div>
                        <div class="avatar">
                            <span class="avatar-initial rounded bg-label-primary">
                                <i class="bx bx-user bx-sm"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-xl-3">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex align-items-start justify-content-between">
                        <div class="content-left">
                            <span>Paid Users</span>
                            <div class="d-flex align-items-end mt-2">
                                <h4 class="mb-0 me-2">4,567</h4>
                                <small class="text-success mb-0">(+18%)</small>
                            </div>
                            <small>Last week analytics </small>
                        </div>
                        <div class="avatar">
                            <span class="avatar-initial rounded bg-label-danger">
                                <i class="bx bx-user-check bx-sm"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-xl-3">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex align-items-start justify-content-between">
                        <div class="content-left">
                            <span>Active Users</span>
                            <div class="d-flex align-items-end mt-2">
                                <h4 class="mb-0 me-2">19,860</h4>
                                <small class="text-danger mb-0">(-14%)</small>
                            </div>
                            <small>Last week analytics</small>
                        </div>
                        <div class="avatar">
                            <span class="avatar-initial rounded bg-label-success">
                                <i class="bx bx-group bx-sm"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-xl-3">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex align-items-start justify-content-between">
                        <div class="content-left">
                            <span>Pending Users</span>
                            <div class="d-flex align-items-end mt-2">
                                <h4 class="mb-0 me-2">237</h4>
                                <small class="text-success mb-0">(+42%)</small>
                            </div>
                            <small>Last week analytics</small>
                        </div>
                        <div class="avatar">
                            <span class="avatar-initial rounded bg-label-warning">
                                <i class="bx bx-user-voice bx-sm"></i>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card">
        @*         <div class="card-header border-bottom">
    <h5 class="card-title">Search Filter</h5>
    <div class="d-flex justify-content-between align-items-center row py-3 gap-3 gap-md-0">
    <div class="col-md-4 user_role"><select id="UserRole" class="form-select text-capitalize"><option value=""> Select Role </option><option value="Admin">Admin</option><option value="Author">Author</option><option value="Editor">Editor</option><option value="Maintainer">Maintainer</option><option value="Subscriber">Subscriber</option></select></div>
    <div class="col-md-4 user_plan"><select id="UserPlan" class="form-select text-capitalize"><option value=""> Select Plan </option><option value="Basic">Basic</option><option value="Company">Company</option><option value="Enterprise">Enterprise</option><option value="Team">Team</option></select></div>
    <div class="col-md-4 user_status"><select id="FilterTransaction" class="form-select text-capitalize"><option value=""> Select Status </option><option value="Pending" class="text-capitalize">Pending</option><option value="Active" class="text-capitalize">Active</option><option value="Inactive" class="text-capitalize">Inactive</option></select></div>
    </div>
    </div>
    <div class="card-datatable table-responsive">
    <div id="DataTables_Table_0_wrapper" class="dataTables_wrapper dt-bootstrap5 no-footer">
    <div class="row mx-2"><div class="col-md-2"><div class="me-3"><div class="dataTables_length" id="DataTables_Table_0_length"><label><select name="DataTables_Table_0_length" aria-controls="DataTables_Table_0" class="form-select"><option value="10">10</option><option value="25">25</option><option value="50">50</option><option value="100">100</option></select></label></div></div></div><div class="col-md-10"><div class="dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-end flex-md-row flex-column mb-3 mb-md-0"><div id="DataTables_Table_0_filter" class="dataTables_filter"><label><input type="search" class="form-control" placeholder="Search.." aria-controls="DataTables_Table_0"></label></div><div class="dt-buttons"> <button class="dt-button buttons-collection dropdown-toggle btn btn-label-secondary mx-3" tabindex="0" aria-controls="DataTables_Table_0" type="button" aria-haspopup="dialog" aria-expanded="false"><span><i class="bx bx-export me-1"></i>Export</span><span class="dt-down-arrow">▼</span></button> <button class="dt-button add-new btn btn-primary ms-n1" tabindex="0" aria-controls="DataTables_Table_0" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasAddUser"><span><i class="bx bx-plus me-0 me-lg-2"></i><span class="d-none d-lg-inline-block">Add Opportunity</span></span></button> </div></div></div></div><table class="datatables-users table dataTable no-footer dtr-column collapsed" id="DataTables_Table_0" aria-describedby="DataTables_Table_0_info" style="width: 918px;">
    <thead class="border-top">
    <tr>
    <th class="control sorting_disabled" rowspan="1" colspan="1" style="width: 1px;" aria-label=""></th>
    <th class="sorting sorting_desc" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 230px;" aria-label="User: activate to sort column ascending" aria-sort="descending">User</th>
    <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 110px;" aria-label="Role: activate to sort column ascending">Role</th>
    <th class="sorting dtr-hidden" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 71px; display: none;" aria-label="Plan: activate to sort column ascending">Plan</th>
    <th class="sorting dtr-hidden" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 138px; display: none;" aria-label="Billing: activate to sort column ascending">Billing</th>
    <th class="sorting dtr-hidden" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 74px; display: none;" aria-label="Status: activate to sort column ascending">Status</th>
    <th class="sorting_disabled dtr-hidden" rowspan="1" colspan="1" style="width: 0px; display: none;" aria-label="Actions">Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td class="control" tabindex="0" style=""></td>
    <td class="sorting_1" style="">
    <div class="d-flex justify-content-start align-items-center user-name">
    <div class="avatar-wrapper">
    <div class="avatar avatar-sm me-3">
    <img src="/assets/img/avatars/2.png" alt="Avatar" class="rounded-circle">
    </div>
    </div>
    <div class="d-flex flex-column">
    <a href="app-user-view-account.html" class="text-body text-truncate">
    <span class="fw-medium">Zsazsa McCleverty</span>
    </a>
    <small class="text-muted">zmcclevertye@soundcloud.com</small>
    </div>
    </div>
    </td>
    <td class="" style="">
    <span class="text-truncate d-flex align-items-center">
    <span class="badge badge-center rounded-pill bg-label-primary w-px-30 h-px-30 me-2">
    <i class="bx bx-pie-chart-alt bx-xs"></i>
    </span>Maintainer
    </span>
    </td>
    <td class="dtr-hidden" style="display: none;"><span class="fw-medium">Enterprise</span></td>
    <td class="dtr-hidden" style="display: none;">Auto Debit</td>
    <td class="dtr-hidden" style="display: none;"><span class="badge bg-label-success">Active</span></td>
    <td class="dtr-hidden" style="display: none;"><div class="d-inline-block text-nowrap"><button class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></button><button class="btn btn-sm btn-icon delete-record"><i class="bx bx-trash"></i></button><button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="app-user-view-account.html" class="dropdown-item">View</a><a href="javascript:;" class="dropdown-item">Suspend</a></div></div></td>
    </tr>
    <tr class="even"><td class="control" tabindex="0" style=""></td><td class="sorting_1" style=""><div class="d-flex justify-content-start align-items-center user-name"><div class="avatar-wrapper"><div class="avatar avatar-sm me-3"><img src="/assets/img/avatars/7.png" alt="Avatar" class="rounded-circle"></div></div><div class="d-flex flex-column"><a href="app-user-view-account.html" class="text-body text-truncate"><span class="fw-medium">Yoko Pottie</span></a><small class="text-muted">ypottiec@privacy.gov.au</small></div></div></td><td class="" style=""><span class="text-truncate d-flex align-items-center"><span class="badge badge-center rounded-pill bg-label-warning w-px-30 h-px-30 me-2"><i class="bx bx-user bx-xs"></i></span>Subscriber</span></td><td class="dtr-hidden" style="display: none;"><span class="fw-medium">Basic</span></td><td class="dtr-hidden" style="display: none;">Auto Debit</td><td class="dtr-hidden" style="display: none;"><span class="badge bg-label-secondary">Inactive</span></td><td class="dtr-hidden" style="display: none;"><div class="d-inline-block text-nowrap"><button class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></button><button class="btn btn-sm btn-icon delete-record"><i class="bx bx-trash"></i></button><button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="app-user-view-account.html" class="dropdown-item">View</a><a href="javascript:;" class="dropdown-item">Suspend</a></div></div></td></tr>
    <tr class="odd"><td class="control" tabindex="0" style=""></td><td class="sorting_1" style=""><div class="d-flex justify-content-start align-items-center user-name"><div class="avatar-wrapper"><div class="avatar avatar-sm me-3"><img src="/assets/img/avatars/6.png" alt="Avatar" class="rounded-circle"></div></div><div class="d-flex flex-column"><a href="app-user-view-account.html" class="text-body text-truncate"><span class="fw-medium">Wesley Burland</span></a><small class="text-muted">wburlandj@uiuc.edu</small></div></div></td><td class="" style=""><span class="text-truncate d-flex align-items-center"><span class="badge badge-center rounded-pill bg-label-info w-px-30 h-px-30 me-2"><i class="bx bx-edit bx-xs"></i></span>Editor</span></td><td class="dtr-hidden" style="display: none;"><span class="fw-medium">Team</span></td><td class="dtr-hidden" style="display: none;">Auto Debit</td><td class="dtr-hidden" style="display: none;"><span class="badge bg-label-secondary">Inactive</span></td><td class="dtr-hidden" style="display: none;"><div class="d-inline-block text-nowrap"><button class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></button><button class="btn btn-sm btn-icon delete-record"><i class="bx bx-trash"></i></button><button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="app-user-view-account.html" class="dropdown-item">View</a><a href="javascript:;" class="dropdown-item">Suspend</a></div></div></td></tr>
    <tr class="even"><td class="control" tabindex="0" style=""></td><td class="sorting_1" style=""><div class="d-flex justify-content-start align-items-center user-name"><div class="avatar-wrapper"><div class="avatar avatar-sm me-3"><span class="avatar-initial rounded-circle bg-label-dark">VK</span></div></div><div class="d-flex flex-column"><a href="app-user-view-account.html" class="text-body text-truncate"><span class="fw-medium">Vladamir Koschek</span></a><small class="text-muted">vkoschek17@abc.net.au</small></div></div></td><td class="" style=""><span class="text-truncate d-flex align-items-center"><span class="badge badge-center rounded-pill bg-label-success w-px-30 h-px-30 me-2"><i class="bx bx-cog bx-xs"></i></span>Author</span></td><td class="dtr-hidden" style="display: none;"><span class="fw-medium">Team</span></td><td class="dtr-hidden" style="display: none;">Manual - Paypal</td><td class="dtr-hidden" style="display: none;"><span class="badge bg-label-success">Active</span></td><td class="dtr-hidden" style="display: none;"><div class="d-inline-block text-nowrap"><button class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></button><button class="btn btn-sm btn-icon delete-record"><i class="bx bx-trash"></i></button><button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="app-user-view-account.html" class="dropdown-item">View</a><a href="javascript:;" class="dropdown-item">Suspend</a></div></div></td></tr>
    <tr class="odd"><td class="control" tabindex="0" style=""></td><td class="sorting_1" style=""><div class="d-flex justify-content-start align-items-center user-name"><div class="avatar-wrapper"><div class="avatar avatar-sm me-3"><span class="avatar-initial rounded-circle bg-label-danger">TW</span></div></div><div class="d-flex flex-column"><a href="app-user-view-account.html" class="text-body text-truncate"><span class="fw-medium">Tyne Widmore</span></a><small class="text-muted">twidmore12@bravesites.com</small></div></div></td><td class="" style=""><span class="text-truncate d-flex align-items-center"><span class="badge badge-center rounded-pill bg-label-warning w-px-30 h-px-30 me-2"><i class="bx bx-user bx-xs"></i></span>Subscriber</span></td><td class="dtr-hidden" style="display: none;"><span class="fw-medium">Team</span></td><td class="dtr-hidden" style="display: none;">Manual - Cash</td><td class="dtr-hidden" style="display: none;"><span class="badge bg-label-warning">Pending</span></td><td class="dtr-hidden" style="display: none;"><div class="d-inline-block text-nowrap"><button class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></button><button class="btn btn-sm btn-icon delete-record"><i class="bx bx-trash"></i></button><button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="app-user-view-account.html" class="dropdown-item">View</a><a href="javascript:;" class="dropdown-item">Suspend</a></div></div></td></tr>
    <tr class="even"><td class="control" tabindex="0" style=""></td><td class="sorting_1" style=""><div class="d-flex justify-content-start align-items-center user-name"><div class="avatar-wrapper"><div class="avatar avatar-sm me-3"><span class="avatar-initial rounded-circle bg-label-warning">TB</span></div></div><div class="d-flex flex-column"><a href="app-user-view-account.html" class="text-body text-truncate"><span class="fw-medium">Travus Bruntjen</span></a><small class="text-muted">tbruntjeni@sitemeter.com</small></div></div></td><td class="" style=""><span class="text-truncate d-flex align-items-center"><span class="badge badge-center rounded-pill bg-label-secondary w-px-30 h-px-30 me-2"><i class="bx bx-mobile-alt bx-xs"></i></span>Admin</span></td><td class="dtr-hidden" style="display: none;"><span class="fw-medium">Enterprise</span></td><td class="dtr-hidden" style="display: none;">Manual - Cash</td><td class="dtr-hidden" style="display: none;"><span class="badge bg-label-success">Active</span></td><td class="dtr-hidden" style="display: none;"><div class="d-inline-block text-nowrap"><button class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></button><button class="btn btn-sm btn-icon delete-record"><i class="bx bx-trash"></i></button><button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="app-user-view-account.html" class="dropdown-item">View</a><a href="javascript:;" class="dropdown-item">Suspend</a></div></div></td></tr>
    <tr class="odd"><td class="control" tabindex="0" style=""></td><td class="sorting_1" style=""><div class="d-flex justify-content-start align-items-center user-name"><div class="avatar-wrapper"><div class="avatar avatar-sm me-3"><img src="/assets/img/avatars/1.png" alt="Avatar" class="rounded-circle"></div></div><div class="d-flex flex-column"><a href="app-user-view-account.html" class="text-body text-truncate"><span class="fw-medium">Stu Delamaine</span></a><small class="text-muted">sdelamainek@who.int</small></div></div></td><td class="" style=""><span class="text-truncate d-flex align-items-center"><span class="badge badge-center rounded-pill bg-label-success w-px-30 h-px-30 me-2"><i class="bx bx-cog bx-xs"></i></span>Author</span></td><td class="dtr-hidden" style="display: none;"><span class="fw-medium">Basic</span></td><td class="dtr-hidden" style="display: none;">Auto Debit</td><td class="dtr-hidden" style="display: none;"><span class="badge bg-label-warning">Pending</span></td><td class="dtr-hidden" style="display: none;"><div class="d-inline-block text-nowrap"><button class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></button><button class="btn btn-sm btn-icon delete-record"><i class="bx bx-trash"></i></button><button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="app-user-view-account.html" class="dropdown-item">View</a><a href="javascript:;" class="dropdown-item">Suspend</a></div></div></td></tr>
    <tr class="even"><td class="control" tabindex="0" style=""></td><td class="sorting_1" style=""><div class="d-flex justify-content-start align-items-center user-name"><div class="avatar-wrapper"><div class="avatar avatar-sm me-3"><span class="avatar-initial rounded-circle bg-label-warning">SO</span></div></div><div class="d-flex flex-column"><a href="app-user-view-account.html" class="text-body text-truncate"><span class="fw-medium">Saunder Offner</span></a><small class="text-muted">soffner19@mac.com</small></div></div></td><td class="" style=""><span class="text-truncate d-flex align-items-center"><span class="badge badge-center rounded-pill bg-label-primary w-px-30 h-px-30 me-2"><i class="bx bx-pie-chart-alt bx-xs"></i></span>Maintainer</span></td><td class="dtr-hidden" style="display: none;"><span class="fw-medium">Enterprise</span></td><td class="dtr-hidden" style="display: none;">Auto Debit</td><td class="dtr-hidden" style="display: none;"><span class="badge bg-label-warning">Pending</span></td><td class="dtr-hidden" style="display: none;"><div class="d-inline-block text-nowrap"><button class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></button><button class="btn btn-sm btn-icon delete-record"><i class="bx bx-trash"></i></button><button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="app-user-view-account.html" class="dropdown-item">View</a><a href="javascript:;" class="dropdown-item">Suspend</a></div></div></td></tr>
    <tr class="odd"><td class="control" tabindex="0" style=""></td><td class="sorting_1" style=""><div class="d-flex justify-content-start align-items-center user-name"><div class="avatar-wrapper"><div class="avatar avatar-sm me-3"><span class="avatar-initial rounded-circle bg-label-danger">SM</span></div></div><div class="d-flex flex-column"><a href="app-user-view-account.html" class="text-body text-truncate"><span class="fw-medium">Stephen MacGilfoyle</span></a><small class="text-muted">smacgilfoyley@bigcartel.com</small></div></div></td><td class="" style=""><span class="text-truncate d-flex align-items-center"><span class="badge badge-center rounded-pill bg-label-primary w-px-30 h-px-30 me-2"><i class="bx bx-pie-chart-alt bx-xs"></i></span>Maintainer</span></td><td class="dtr-hidden" style="display: none;"><span class="fw-medium">Company</span></td><td class="dtr-hidden" style="display: none;">Manual - Paypal</td><td class="dtr-hidden" style="display: none;"><span class="badge bg-label-warning">Pending</span></td><td class="dtr-hidden" style="display: none;"><div class="d-inline-block text-nowrap"><button class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></button><button class="btn btn-sm btn-icon delete-record"><i class="bx bx-trash"></i></button><button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="app-user-view-account.html" class="dropdown-item">View</a><a href="javascript:;" class="dropdown-item">Suspend</a></div></div></td></tr>
    <tr class="even"><td class="control" tabindex="0" style=""></td><td class="sorting_1" style=""><div class="d-flex justify-content-start align-items-center user-name"><div class="avatar-wrapper"><div class="avatar avatar-sm me-3"><img src="/assets/img/avatars/9.png" alt="Avatar" class="rounded-circle"></div></div><div class="d-flex flex-column"><a href="app-user-view-account.html" class="text-body text-truncate"><span class="fw-medium">Skip Hebblethwaite</span></a><small class="text-muted">shebblethwaite10@arizona.edu</small></div></div></td><td class="" style=""><span class="text-truncate d-flex align-items-center"><span class="badge badge-center rounded-pill bg-label-secondary w-px-30 h-px-30 me-2"><i class="bx bx-mobile-alt bx-xs"></i></span>Admin</span></td><td class="dtr-hidden" style="display: none;"><span class="fw-medium">Company</span></td><td class="dtr-hidden" style="display: none;">Manual - Cash</td><td class="dtr-hidden" style="display: none;"><span class="badge bg-label-secondary">Inactive</span></td><td class="dtr-hidden" style="display: none;"><div class="d-inline-block text-nowrap"><button class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></button><button class="btn btn-sm btn-icon delete-record"><i class="bx bx-trash"></i></button><button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button><div class="dropdown-menu dropdown-menu-end m-0"><a href="app-user-view-account.html" class="dropdown-item">View</a><a href="javascript:;" class="dropdown-item">Suspend</a></div></div></td></tr>
    </tbody>
    </table><div class="row mx-2"><div class="col-sm-12 col-md-6"><div class="dataTables_info" id="DataTables_Table_0_info" role="status" aria-live="polite">Showing 1 to 10 of 50 entries</div></div><div class="col-sm-12 col-md-6"><div class="dataTables_paginate paging_simple_numbers" id="DataTables_Table_0_paginate"><ul class="pagination"><li class="paginate_button page-item previous disabled" id="DataTables_Table_0_previous"><a aria-controls="DataTables_Table_0" aria-disabled="true" role="link" data-dt-idx="previous" tabindex="-1" class="page-link">Previous</a></li><li class="paginate_button page-item active"><a href="#" aria-controls="DataTables_Table_0" role="link" aria-current="page" data-dt-idx="0" tabindex="0" class="page-link">1</a></li><li class="paginate_button page-item "><a href="#" aria-controls="DataTables_Table_0" role="link" data-dt-idx="1" tabindex="0" class="page-link">2</a></li><li class="paginate_button page-item "><a href="#" aria-controls="DataTables_Table_0" role="link" data-dt-idx="2" tabindex="0" class="page-link">3</a></li><li class="paginate_button page-item "><a href="#" aria-controls="DataTables_Table_0" role="link" data-dt-idx="3" tabindex="0" class="page-link">4</a></li><li class="paginate_button page-item "><a href="#" aria-controls="DataTables_Table_0" role="link" data-dt-idx="4" tabindex="0" class="page-link">5</a></li><li class="paginate_button page-item next" id="DataTables_Table_0_next"><a href="#" aria-controls="DataTables_Table_0" role="link" data-dt-idx="next" tabindex="0" class="page-link">Next</a></li></ul></div></div></div>
    </div>
    </div> *@
        <div class="card-header border-bottom">
            <h5 class="card-title">Search Filter</h5>
            <div class="d-flex justify-content-between align-items-center row py-3 gap-3 gap-md-0">
                <div class="col-md-3 user_role"></div>
                <div class="col-md-3 user_plan"></div>
                <div class="col-md-3 user_status"></div>
                <div class="col-md-3 user_stage"></div>
            </div>
        </div>
        <div class="card-datatable table-responsive">
            <table class="datatables-users table">
                <thead class="border-top">
                    <tr>
                        <th></th>
                        <th>Contact</th>
                        <th>Account</th>
                        <th>Amount</th>
                        <th>Name</th>
                        <th>Notes</th>
                        <th>Closed</th>
                        <th>Type</th>
                        <th>Forecast</th>
                        <th>Stage</th>
                        <th>Actions</th>
                    </tr>
                </thead>
            </table>
        </div>

        <!-- Offcanvas to add new user -->
        <div class="offcanvas offcanvas-end"
             tabindex="-1"
             id="offcanvasAddUser"
             aria-labelledby="offcanvasAddUserLabel">
            <div class="offcanvas-header border-bottom">
                <h6 id="offcanvasAddUserLabel" class="offcanvas-title">Add Opportunity</h6>
                <button type="button"
                        class="btn-close text-reset"
                        data-bs-dismiss="offcanvas"
                        aria-label="Close"></button>
            </div>
            <div class="offcanvas-body mx-0 flex-grow-0">
                <form asp-action="Create" asp-controller="ActionItems">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    @* <input type="hidden" asp-for="@ActionItem.SubmitterId" name="SubmitterId" /> *@
                    <div class="mb-3">
                        <label class="form-label" for="contact">Contact</label>
                        <select asp-for="@ActionItem.ContactId" class=" form-control" asp-items="ViewBag.ContactId">
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="account">Account</label>
                        <select asp-for="@ActionItem.AccountId" class=" form-control" asp-items="ViewBag.AccountId">
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="name">Name</label>
                        <input asp-for="@ActionItem.Title" class="form-control" placeholder="Opportunity Name" aria-label="Opportunity Name" />
                    </div>
                    <div class="mb-3">
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" asp-for="@ActionItem.Amount"
                                   class="form-control"
                                   placeholder="Amount"
                                   aria-label="Amount (to the nearest dollar)" />
                            <span class="input-group-text">.00</span>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="closedDate">Closed Date</label>
                        <input class="form-control"
                               asp-for="@ActionItem.ClosedDate"
                               placeholder="Closed Date" />
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="stage">Stage</label>
                        <select asp-for="@ActionItem.OpportunityStage" class=" form-select" asp-items="@Html.GetEnumSelectList<OpportunityStage>()">
                            <option></option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="forecast">Forecast</label>
                        <select asp-for="@ActionItem.OpportunityForecastCategory" class=" form-select" asp-items="@Html.GetEnumSelectList<OpportunityForecastCategory>()">
                            <option></option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label" for="type">Type</label>
                        <select asp-for="@ActionItem.OpportunityType" class=" form-select" asp-items="@Html.GetEnumSelectList<OpportunityType>()">
                            <option></option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <div class="input-group input-group-merge form-send-message">
                            <textarea asp-for="@ActionItem.Notes" class="form-control message-input" placeholder="Say it" rows="5"></textarea>
                            <span class="message-actions input-group-text">
                                <i class="bx bx-microphone cursor-pointer speech-to-text"></i>
                            </span>
                            @*                         <div class="card m-0">
                        <div class="card-body">
                        <div id="notes-toolbar">
                        <span class="ql-formats">
                        <select class="ql-font"></select>
                        <select class="ql-size"></select>
                        </span>
                        <span class="ql-formats">
                        <button class="ql-bold"></button>
                        <button class="ql-italic"></button>
                        <button class="ql-underline"></button>
                        <button class="ql-strike"></button>
                        </span>
                        <span class="ql-formats">
                        <select class="ql-color"></select>
                        <select class="ql-background"></select>
                        </span>
                        <span class="ql-formats">
                        <button class="ql-script" value="sub"></button>
                        <button class="ql-script" value="super"></button>
                        </span>
                        <span class="ql-formats">
                        <button class="ql-header" value="1"></button>
                        <button class="ql-header" value="2"></button>
                        <button class="ql-blockquote"></button>
                        <button class="ql-code-block"></button>
                        </span>
                        </div>
                        <div id="notes-editor" for="@ActionItem.Notes">
                        <h6>Quill Rich Text Editor</h6>
                        <p>
                        Cupcake ipsum dolor sit amet. Halvah cheesecake chocolate bar gummi bears cupcake. Pie
                        macaroon bear claw. Soufflé I love candy canes I love cotton candy I love.
                        </p>
                        </div>
                        <textarea asp-for="@ActionItem.Notes" name="Notes" class="form-control message-input" placeholder="Say it" rows="5" hidden></textarea>
                        </div>
                        </div>*@
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary me-sm-3 me-1 data-submit">Submit</button>
                    <button type="reset" class="btn btn-label-secondary" data-bs-dismiss="offcanvas">Cancel</button>
                </form>
            </div>
        </div>

    </div>
}
else
{
    <div class="block-header">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="breadcrumb breadcrumb-style ">
                    <li class="breadcrumb-item">
                        <h4 class="page-title">Dashboard</h4>
                    </li>
                    <li class="breadcrumb-item bcrumb-1">
                        <a asp-action="Dashboard_new" asp-controller="Home">
                            <i class="fas fa-home"></i> Home
                        </a>
                    </li>
                    <li class="breadcrumb-item active">Tickets</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Page Header -->
    <div class="page-header mb-5">
        <div class="row align-items-center">
            <div class="col-auto float-end ms-auto">
                <a asp-action="Create" asp-controller="ActionItems" asp-route-contactId="" class="btn add-btn"><i class="fa fa-plus"></i> Add Ticket</a>
            </div>
        </div>
    </div>
    <!-- /Page Header -->

    <div id="tableDiv" class="row">
        <div class="col-md-12 table-responsive pb-3">
            <table id="contact-table" class="table table-striped custom-table"></table>
            <table class="table table-striped custom-table" id="action-table">
                <thead>
                    <tr>
                        <th>Contact</th>
                        <th>Holder</th>
                        <th>Sales Rep</th>
                        <th>
                            Action
                        </th>
                        <th>
                            Created
                        </th>
                        <th>
                            Last Updated
                        </th>
                        <th>
                            Priority
                        </th>
                        <th>
                            Type
                        </th>
                        <th>
                            Status
                        </th>
                        <th>
                            Developer
                        </th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => item.Contact!.FullName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Contact!.RelationshipHolder!.FullName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Contact!.SalesRepresentative!.FullName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Title)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Created)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Updated)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ItemPriority)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ItemType)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ItemStatus)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Actor!.FullName)
                            </td>
                            <td>
                                <a asp-action="Edit" asp-route-id="@item.Id">Edit</a> |
                                <a asp-controller="Tickets" asp-action="Details" asp-route-id="@item.Id">Details</a>
                                @if (User.IsInRole(nameof(BTRoles.Admin)) || User.IsInRole(nameof(BTRoles.ProjectManager)))
                                {
                                    <span>|</span>
                                    <a asp-action="Archive" asp-route-id="@item.Id">Archive</a>

                                }
                            </td>
                        </tr>
                    }
                </tbody>
                <tfoot>
                    <tr>
                        <th>Contact</th>
                        <th>Holder</th>
                        <th>Sales Rep</th>
                        <th>
                            Action
                        </th>
                        <th>
                            Created
                        </th>
                        <th>
                            Last Updated
                        </th>
                        <th>
                            Priority
                        </th>
                        <th>
                            Type
                        </th>
                        <th>
                            Status
                        </th>
                        <th>
                            Developer
                        </th>
                        <th></th>
                    </tr>
                </tfoot>
            </table>

        </div>
    </div>
    <!-- /Page Content -->
}


@section scripts {

    <script src="~/assets/vendor/libs/select2/select2.js"></script>
    <script src="~/assets/vendor/libs/form-validation/umd/bundle/popular.min.js"></script>
    <script src="~/assets/vendor/libs/form-validation/umd/plugin-bootstrap5/index.min.js"></script>
    <script src="~/assets/vendor/libs/form-validation/umd/plugin-auto-focus/index.min.js"></script>
    <script src="~/assets/vendor/libs/cleavejs/cleave.js"></script>
    <script src="~/assets/vendor/libs/cleavejs/cleave-phone.js"></script>


    <!-- Vendors JS -->
    <script src="~/assets/vendor/libs/fullcalendar/fullcalendar.js"></script>
    <script src="~/assets/vendor/libs/flatpickr/flatpickr.js"></script>


    <!-- Page JS -->
    <script src="~/assets/js/app-calendar-events.js"></script>
    <script src="~/assets/js/app-calendar.js"></script>

    <!-- Page JS -->
    @* <script src="~/assets/js/app-user-list.js"></script> *@

    <script src="~/assets/js/form-input-group.js"></script>

    <script>
        (function () {
            // Snow Theme
            // --------------------------------------------------------------------
            const snowEditor = new Quill('#notes-editor', {
                bounds: '#notes-editor',
                modules: {
                    formula: true,
                    toolbar: '#notes-toolbar'
                },
                theme: 'snow'
            });

            var form = document.querySelector('form');
            form.onsubmit = function () {
                // Populate hidden form on submit
                var notes = document.querySelector('input[name=actionItem.Notes]');
                notes.value = snowEditor.getContents();
            };
        })();

    </script>

    <script>
        'use strict';

        // Datatable (jquery)
        $(function () {
            let borderColor, bodyBg, headingColor;

            if (isDarkStyle) {
                borderColor = config.colors_dark.borderColor;
                bodyBg = config.colors_dark.bodyBg;
                headingColor = config.colors_dark.headingColor;
            } else {
                borderColor = config.colors.borderColor;
                bodyBg = config.colors.bodyBg;
                headingColor = config.colors.headingColor;
            }

            // Variable declaration for table
            var dt_user_table = $('.datatables-users'),
                select2 = $('.select2'),
                userView = '/frest/app-user-view-account.html',
                statusObj = {
        @((int)OpportunityType.NewBusiness) : { title: 'New Business', class: 'bg-label-success' },
        @((int)OpportunityType.Expansion): { title: 'Expansion', class: 'bg-label-secondary' },
        @((int)OpportunityType.Renewal): { title: 'Renewal', class: 'bg-label-primary' },
        @((int)OpportunityType.PartnerDeal): { title: 'Partner Deal', class: 'bg-label-warning' }
        };

        if (select2.length) {
            var $this = select2;
            $this.wrap('<div class="position-relative"></div>').select2({
                placeholder: 'Select Country',
                dropdownParent: $this.parent()
            });
        }

        // Users datatable
        if (dt_user_table.length) {
            var dt_user = dt_user_table.DataTable({
                //ajax: assetsPath + 'json/user-list.json', // JSON file to add data
                ajax: {
                    url: "/ActionItems/GetTableData",
                    type: "POST",
                    dataType: "JSON",
                    dataSrc: function (json) {

                        return json;
                    }
                },
                columns: [
                    // columns according to JSON
                    { data: '' },
                    { data: 'contact' },
                    { data: 'account' },
                    { data: 'amount' },
                    { data: 'title' },
                    { data: 'notes' },
                    { data: 'closed_date' },
                    { data: 'opportunity_type' },
                    { data: 'opportunity_forecast' },
                    { data: 'opportunity_stage' },
                    { data: 'action' }
                ],
                columnDefs: [
                    {
                        // For Responsive
                        className: 'control',
                        searchable: false,
                        orderable: false,
                        responsivePriority: 2,
                        targets: 0,
                        render: function (data, type, full, meta) {
                            return '';
                        }
                    },
                    {
                        // User full name and email
                        targets: 1,
                        responsivePriority: 4,
                        render: function (data, type, full, meta) {
                            var $name = full['contact'],
                                $email = full['email'];
                            // For Avatar badge
                            var stateNum = Math.floor(Math.random() * 6);
                            var states = ['success', 'danger', 'warning', 'info', 'dark', 'primary', 'secondary'];
                            var $state = states[stateNum],
                                $name = full['contact'],
                                $initials = $name.match(/\b\w/g) || [];
                            $initials = (($initials.shift() || '') + ($initials.pop() || '')).toUpperCase();
                            var $output = '<span class="avatar-initial rounded-circle bg-label-' + $state + '">' + $initials + '</span>';
                            userView = '/Contacts/Details/' + full['contact_id'];
                            // Creates full output for row
                            var $row_output =
                                '<div class="d-flex justify-content-start align-items-center user-name">' +
                                '<div class="avatar-wrapper">' +
                                '<div class="avatar avatar-sm me-3">' +
                                $output +
                                '</div>' +
                                '</div>' +
                                '<div class="d-flex flex-column">' +
                                '<a href="' +
                                userView +
                                '" class="text-body text-truncate"><span class="fw-medium">' +
                                $name +
                                '</span></a>' +
                                '<small class="text-muted">' +
                                $email +
                                '</small>' +
                                '</div>' +
                                '</div>';
                            return $row_output;
                        }
                    },
                    // {
                    //     // User Role
                    //     targets: 2,
                    //     render: function (data, type, full, meta) {
                    //         var $role = full['role'];
                    //         var roleBadgeObj = {
                    //             Subscriber:
                    //                 '<span class="badge badge-center rounded-pill bg-label-warning w-px-30 h-px-30 me-2"><i class="bx bx-user bx-xs"></i></span>',
                    //             Author:
                    //                 '<span class="badge badge-center rounded-pill bg-label-success w-px-30 h-px-30 me-2"><i class="bx bx-cog bx-xs"></i></span>',
                    //             Maintainer:
                    //                 '<span class="badge badge-center rounded-pill bg-label-primary w-px-30 h-px-30 me-2"><i class="bx bx-pie-chart-alt bx-xs"></i></span>',
                    //             Editor:
                    //                 '<span class="badge badge-center rounded-pill bg-label-info w-px-30 h-px-30 me-2"><i class="bx bx-edit bx-xs"></i></span>',
                    //             Admin:
                    //                 '<span class="badge badge-center rounded-pill bg-label-secondary w-px-30 h-px-30 me-2"><i class="bx bx-mobile-alt bx-xs"></i></span>'
                    //         };
                    //         return "<span class='text-truncate d-flex align-items-center'>" + roleBadgeObj[$role] + $role + '</span>';
                    //     }
                    // },
                    // {
                    //     // Plans
                    //     targets: 3,
                    //     render: function (data, type, full, meta) {
                    //         var $plan = full['current_plan'];

                    //         return '<span class="fw-medium">' + $plan + '</span>';
                    //     }
                    // },
                    {
                        // Opportunity Type
                        targets: 7,
                        render: function (data, type, full, meta) {
                            //var op_id = full['opportunity_typeid'];
                            var $op_type = full['opportunity_type'];
                            //if ($op_type != undefined) {
                                //return '<span class="badge ' + statusObj[$op_type].class + '">' + statusObj[$op_type].title + '</span>';
                            //} else {
                                return '<span>'+$op_type+'</span>';
                            //}
                        }
                    },
                    {
                        // Actions
                        targets: -1,
                        title: 'Actions',
                        searchable: false,
                        orderable: false,
                        render: function (data, type, full, meta) {
                            return (
                                '<div class="d-inline-block text-nowrap">' +
                                '<a href="/ActionItems/Edit/' + full['opportunity_id'] + '" class="btn btn-sm btn-icon"><i class="bx bx-edit"></i></a>' +
                                '<button class="btn btn-sm btn-icon delete-record"><i class="bx bx-hide"></i></button>' +
                                '<button class="btn btn-sm btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown"><i class="bx bx-dots-vertical-rounded me-2"></i></button>' +
                                '<div class="dropdown-menu dropdown-menu-end m-0">' +
                                '<a href="/ActionItems/Details/' + full['opportunity_id'] + '" class="dropdown-item">View</a>' +
                                '<a href="/ActionItems/Archive/' + full['opportunity_id'] + '" class="dropdown-item">Archive</a>' +
                                '</div>' +
                                '</div>'
                            );
                        }
                    }
                ],
                order: [[1, 'desc']],
                dom:
                    '<"row mx-2"' +
                    '<"col-md-2"<"me-3"l>>' +
                    '<"col-md-10"<"dt-action-buttons text-xl-end text-lg-start text-md-end text-start d-flex align-items-center justify-content-end flex-md-row flex-column mb-3 mb-md-0"fB>>' +
                    '>t' +
                    '<"row mx-2"' +
                    '<"col-sm-12 col-md-6"i>' +
                    '<"col-sm-12 col-md-6"p>' +
                    '>',
                language: {
                    sLengthMenu: '_MENU_',
                    search: '',
                    searchPlaceholder: 'Search..'
                },
                // Buttons with Dropdown
                buttons: [
                    {
                        extend: 'collection',
                        className: 'btn btn-label-secondary dropdown-toggle mx-3',
                        text: '<i class="bx bx-export me-1"></i>Export',
                        buttons: [
                            {
                                extend: 'print',
                                text: '<i class="bx bx-printer me-2" ></i>Print',
                                className: 'dropdown-item',
                                exportOptions: {
                                    columns: [1, 2, 3, 4, 5],
                                    // prevent avatar to be print
                                    format: {
                                        body: function (inner, coldex, rowdex) {
                                            if (inner.length <= 0) return inner;
                                            var el = $.parseHTML(inner);
                                            var result = '';
                                            $.each(el, function (index, item) {
                                                if (item.classList !== undefined && item.classList.contains('user-name')) {
                                                    result = result + item.lastChild.firstChild.textContent;
                                                } else if (item.innerText === undefined) {
                                                    result = result + item.textContent;
                                                } else result = result + item.innerText;
                                            });
                                            return result;
                                        }
                                    }
                                },
                                customize: function (win) {
                                    //customize print view for dark
                                    $(win.document.body)
                                        .css('color', headingColor)
                                        .css('border-color', borderColor)
                                        .css('background-color', bodyBg);
                                    $(win.document.body)
                                        .find('table')
                                        .addClass('compact')
                                        .css('color', 'inherit')
                                        .css('border-color', 'inherit')
                                        .css('background-color', 'inherit');
                                }
                            },
                            {
                                extend: 'csv',
                                text: '<i class="bx bx-file me-2" ></i>Csv',
                                className: 'dropdown-item',
                                exportOptions: {
                                    columns: [1, 2, 3, 4, 5],
                                    // prevent avatar to be display
                                    format: {
                                        body: function (inner, coldex, rowdex) {
                                            if (inner.length <= 0) return inner;
                                            var el = $.parseHTML(inner);
                                            var result = '';
                                            $.each(el, function (index, item) {
                                                if (item.classList !== undefined && item.classList.contains('user-name')) {
                                                    result = result + item.lastChild.firstChild.textContent;
                                                } else if (item.innerText === undefined) {
                                                    result = result + item.textContent;
                                                } else result = result + item.innerText;
                                            });
                                            return result;
                                        }
                                    }
                                }
                            },
                            {
                                extend: 'excel',
                                text: '<i class="bx bxs-file-export me-2"></i>Excel',
                                className: 'dropdown-item',
                                exportOptions: {
                                    columns: [1, 2, 3, 4, 5],
                                    // prevent avatar to be display
                                    format: {
                                        body: function (inner, coldex, rowdex) {
                                            if (inner.length <= 0) return inner;
                                            var el = $.parseHTML(inner);
                                            var result = '';
                                            $.each(el, function (index, item) {
                                                if (item.classList !== undefined && item.classList.contains('user-name')) {
                                                    result = result + item.lastChild.firstChild.textContent;
                                                } else if (item.innerText === undefined) {
                                                    result = result + item.textContent;
                                                } else result = result + item.innerText;
                                            });
                                            return result;
                                        }
                                    }
                                }
                            },
                            {
                                extend: 'pdf',
                                text: '<i class="bx bxs-file-pdf me-2"></i>Pdf',
                                className: 'dropdown-item',
                                exportOptions: {
                                    columns: [1, 2, 3, 4, 5],
                                    // prevent avatar to be display
                                    format: {
                                        body: function (inner, coldex, rowdex) {
                                            if (inner.length <= 0) return inner;
                                            var el = $.parseHTML(inner);
                                            var result = '';
                                            $.each(el, function (index, item) {
                                                if (item.classList !== undefined && item.classList.contains('user-name')) {
                                                    result = result + item.lastChild.firstChild.textContent;
                                                } else if (item.innerText === undefined) {
                                                    result = result + item.textContent;
                                                } else result = result + item.innerText;
                                            });
                                            return result;
                                        }
                                    }
                                }
                            },
                            {
                                extend: 'copy',
                                text: '<i class="bx bx-copy me-2" ></i>Copy',
                                className: 'dropdown-item',
                                exportOptions: {
                                    columns: [1, 2, 3, 4, 5],
                                    // prevent avatar to be display
                                    format: {
                                        body: function (inner, coldex, rowdex) {
                                            if (inner.length <= 0) return inner;
                                            var el = $.parseHTML(inner);
                                            var result = '';
                                            $.each(el, function (index, item) {
                                                if (item.classList !== undefined && item.classList.contains('user-name')) {
                                                    result = result + item.lastChild.firstChild.textContent;
                                                } else if (item.innerText === undefined) {
                                                    result = result + item.textContent;
                                                } else result = result + item.innerText;
                                            });
                                            return result;
                                        }
                                    }
                                }
                            }
                        ]
                    },
                    {
                        text: '<i class="bx bx-plus me-0 me-lg-2"></i><span class="d-none d-lg-inline-block">Add Opportunity</span>',
                        className: 'add-new btn btn-primary ms-n1',
                        attr: {
                            'data-bs-toggle': 'offcanvas',
                            'data-bs-target': '#offcanvasAddUser'
                        }
                    }
                ],
                // For responsive popup
                responsive: {
                    details: {
                        display: $.fn.dataTable.Responsive.display.modal({
                            header: function (row) {
                                var data = row.data();
                                return 'Details of ' + data['contact'];
                            }
                        }),
                        type: 'column',
                        renderer: function (api, rowIdx, columns) {
                            var data = $.map(columns, function (col, i) {
                                return col.title !== '' // ? Do not show row in modal popup if title is blank (for check box)
                                    ? '<tr data-dt-row="' +
                                    col.rowIndex +
                                    '" data-dt-column="' +
                                    col.columnIndex +
                                    '">' +
                                    '<td>' +
                                    col.title +
                                    ':' +
                                    '</td> ' +
                                    '<td>' +
                                    col.data +
                                    '</td>' +
                                    '</tr>'
                                    : '';
                            }).join('');

                            return data ? $('<table class="table"/><tbody />').append(data) : false;
                        }
                    }
                },
                initComplete: function () {
                    // Adding role filter once table initialized
                    this.api()
                        .columns(2)
                        .every(function () {
                            var column = this;
                            var select = $(
                                '<select id="UserRole" class="form-select text-capitalize"><option value=""> Select Account </option></select>'
                            )
                                .appendTo('.user_role')
                                .on('change', function () {
                                    var val = $.fn.dataTable.util.escapeRegex($(this).val());
                                    column.search(val ? '^' + val + '$' : '', true, false).draw();
                                });

                            column
                                .data()
                                .unique()
                                .sort()
                                .each(function (d, j) {
                                    select.append('<option value="' + d + '">' + d + '</option>');
                                });
                        });
                    // Adding plan filter once table initialized
                    this.api()
                        .columns(7)
                        .every(function () {
                            var column = this;
                            var select = $(
                                '<select id="UserPlan" class="form-select text-capitalize"><option value=""> Select Type </option></select>'
                            )
                                .appendTo('.user_plan')
                                .on('change', function () {
                                    var val = $.fn.dataTable.util.escapeRegex($(this).val());
                                    column.search(val ? '^' + val + '$' : '', true, false).draw();
                                });

                            column
                                .data()
                                .unique()
                                .sort()
                                .each(function (d, j) {
                                    select.append('<option value="' + d + '">' + d + '</option>');
                                });
                        });
                    // Adding status filter once table initialized
                    this.api()
                        .columns(8)
                        .every(function () {
                            var column = this;
                            var select = $(
                                '<select id="FilterTransaction" class="form-select text-capitalize"><option value=""> Select Forecast </option></select>'
                            )
                                .appendTo('.user_status')
                                .on('change', function () {
                                    var val = $.fn.dataTable.util.escapeRegex($(this).val());
                                    column.search(val ? '^' + val + '$' : '', true, false).draw();
                                });

                            column
                                .data()
                                .unique()
                                .sort()
                                .each(function (d, j) {
                                    select.append('<option value="' + d + '">' + d + '</option>');
                                });
                        });
                    this.api()
                        .columns(9)
                        .every(function () {
                            var column = this;
                            var select = $(
                                '<select id="OpportunityStage" class="form-select text-capitalize"><option value=""> Select Stage </option></select>'
                            )
                                .appendTo('.user_stage')
                                .on('change', function () {
                                    var val = $.fn.dataTable.util.escapeRegex($(this).val());
                                    column.search(val ? '^' + val + '$' : '', true, false).draw();
                                });

                            column
                                .data()
                                .unique()
                                .sort()
                                .each(function (d, j) {
                                    select.append('<option value="' + d + '">' + d + '</option>');
                                });
                        });
                    // this.api()
                    //     .columns(8)
                    //     .every(function () {
                    //         var column = this;
                    //         var select = $(
                    //             '<select id="FilterTransaction" class="form-select text-capitalize"><option value=""> Select Forecast </option></select>'
                    //         )
                    //             .appendTo('.user_status')
                    //             .on('change', function () {
                    //                 var val = $.fn.dataTable.util.escapeRegex($(this).val());
                    //                 column.search(val ? '^' + val + '$' : '', true, false).draw();
                    //             });

                    //         column
                    //             .data()
                    //             .unique()
                    //             .sort()
                    //             .each(function (d, j) {
                    //                 select.append(
                    //                     '<option value="' +
                    //                     statusObj[d].title +
                    //                     '" class="text-capitalize">' +
                    //                     statusObj[d].title +
                    //                     '</option>'
                    //                 );
                    //             });
                    //     });
                }//here
            });
        }

        // Delete Record
        $('.datatables-users tbody').on('click', '.delete-record', function () {
            dt_user.row($(this).parents('tr')).remove().draw();
        });

        // Filter form control to default size
        // ? setTimeout used for multilingual table initialization
        setTimeout(() => {
            $('.dataTables_filter .form-control').removeClass('form-control-sm');
            $('.dataTables_length .form-select').removeClass('form-select-sm');
        }, 300);
                                });
    </script>




}

